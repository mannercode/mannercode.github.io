---
layout: post
title: "1. 좋은 코드란 무엇인가?"
---

좋은 코드란 어떤 것인가? 이는 추상적이고 주관적인 개념으로, 상황에 따라 그 정의는 변할 수 있다. 하지만 대부분의 프로그래머들은 '읽기 쉽고 변경하기 쉬운 코드'를 좋은 코드라고 평가한다. 그리고 코드를 읽는 목적이 결국 코드를 변경하기 위함이기 때문에, '변경하기 쉬운 코드'라는 간결한 정의를 내릴 수 있다.

좋은 코드에 대한 정의는 개인과 상황에 따라 달라진다. 그래서 이 글은 '좋은 코드가 무엇인가' 그리고 '왜 그렇게 되었는가'에 대한 나의 생각을 담고 있다.

## 좋은 코드가 필요한 이유

프로그래머들이 변경하기 쉬운 코드를 '좋은 코드'로 생각하는 이유는 프로그램이 자주 변경되어야 하기 때문이다.

### 요구사항의 변경

소프트웨어의 요구사항이 자주 변경되는 이유는 무엇일까? 그 원인은 소프트웨어의 본질적인 특성에 있다. 소프트웨어(Software)의 'Soft'는 유연성을 의미한다. 이 유연성은 소프트웨어를 바꿀 수 있는 무형의 특성을 의미한다. 이런 특성은 소프트웨어를 유연하게 만들지만, 무형성으로 인해 구현 과정을 어렵게 만든다.

건축물이나 자동차와 같은 물리적 형태가 있는 제품들은 미리 모델링하거나 미니어처를 만들어서 사용자에게 보여주고 검토할 수 있다. 그러나 소프트웨어는 무형이므로 그럴 수 없다. 그래서 개발이 진행될수록 사용자와 개발자 사이의 이해 차이가 생기고, 이로 인해 요구사항의 큰 변화가 발생한다.

사용자의 생각을 정확히 이해하고 이를 실체화하는 것은 어렵다. 그럼에도 불구하고, 더욱 어려운 점은 사용자의 생각이 계속 변한다는 것이다. 사람의 생각은 창조적이므로 계속해서 새로운 아이디어가 떠오르기 마련이다. 하지만 소프트웨어는 무형성 때문에 언제든지 변경 가능하다는 환상을 줄 수 있어, 출시 직전까지 요구사항 변경에 시달릴 수 있다.

그러므로, 변화는 자연스러운 것이며, 그것을 받아들이고 대응하는 것이 프로그래머의 역할이다. 따라서, 가능한 한 쉽게 변경을 수용할 수 있는 코드를 작성하는 것이 중요하다.

> 흔한 소프트웨어 개발 프로세스
> 1. 요구사항을 정의하는 담당자(갑)가 있다. 프로그래머들은 담당자와 많은 커뮤니케이션을 통해 분석하고 설계하며 검증한다.
> 1. 프로그래머들은 설계대로 열심히 구현하고 내부 테스트를 진행한다.
> 1. 지금까지 프로젝트에 관심이 없던 갑의 상사가 한 마디 한다.
> 1. 담당자(갑)와 프로그래머들은 요구사항을 재정의하고 설계를 변경하고 구현과 테스트를 한다.

<!-- ### 분석 오류

분석 오류는 요구사항의 변경과 밀접한 연관이 있다.

'요구사항 변경'은 프로그래머가 통제할 수 없는 부분이다. 하지만 우리가 무엇을 개발할 것인지를 신중하게 분석하고 설계한다면, '분석 오류'는 줄일 수 있을 것이다.

그럼에도 불구하고, 대부분의 프로젝트가 분석 오류 문제에 직면하고 있다는 것은 '분석 오류'를 줄이는 것이 쉽지 않다는 것을 시사한다. 그 이유는 '요구사항 변경'이 발생하면 기존의 분석과 설계도 따라서 변경해야 하기 때문이다.

그러므로, '요구사항 변경'을 제어할 수 없는 상황에서는 변경으로 인한 문제를 최소화하는 전략을 세우는 것이 중요하다. 그 전략의 산출물이 바로 '좋은 코드'가 된다. -->

### 소프트웨어의 복잡성
프로그램이 자주 변경되는 다른 이유는 소프트웨어의 복잡성 때문이다. 'Grady Booch'의 저서 'Object Oriented Analysis and Design with Applications'에서 이에 대한 통찰을 얻을 수 있다. 요약하면, 소프트웨어는 그 복잡성 때문에 완벽하게 한 번에 만들어내기 어렵다. 점진적으로 개선하면서 완성해 나가는 데, 그 과정에서 변경이 이루어지는 것이다.

> 산업용 소프트웨어 특징으로는 개발자 한 사람이 설계 부분까지 상세히 모두 알기에는 무척 까다롭다.\
> 비록 불가능하지는 않겠지만, 대충 말해 이 정도의 시스템 복잡도라면 인간이 처리하는 지적 능력을 초과한다.\
> 안된 일이지만 이런 복잡성은 대형 소프트웨어 시스템에서는 모두 나타나는 본질적 속성으로 보인다.\
> 본질이라는 말은 복잡성을 정복할 수는 있어도 복잡성 자체를 제거할 수는 없다는 뜻이다.

소프트웨어가 복잡한 이유 또한 소프트웨어의 유연성 때문인데, 유연하기 때문에 표준화가 어렵고 세세한 부분까지 직접 구현해야 하는 요구가 많기 때문에 복잡해진다.

위에서 '요구사항 변경'을 좋은 코드 작성의 주요 도전 과제로 제시했지만, 사실 소프트웨어의 복잡성은 그보다 더 큰 문제일 수 있다. 복잡한 소프트웨어를 이해하고 개발할 수 있는 프로그래머는 많지 않다. 그 만큼 소프트웨어의 복잡성은 개발자들 앞에 높은 장벽으로 다가온다. 이런 복잡성을 효과적으로 관리하고, 동시에 요구사항 변경을 유연하게 수용하는 것이 '좋은 코드'의 핵심 가치다.

### 운영환경의 변화

운영 환경의 변화로 인해 코드를 변경해야 하는 경우도 있다. 예를 들면:

- OS의 업그레이드로 인해 API가 바뀌는 경우.
- 외부 인증 서비스가 중단되거나 비용이 상승해 다른 서비스로 전환해야 하는 경우.
- 사용자가 증가하면서 성능 저하 문제가 발생하는 경우.
- 사용 중인 라이브러리에서 보안 취약점이 발견되거나 라이센스 정책이 변경되는 경우.

장기적으로 보면, 소프트웨어의 운영환경이 변화하는 주요한 원인 중 하나는 하드웨어의 발전이다. 하드웨어는 소프트웨어를 실행하는 '그릇'과도 같다. 하드웨어의 발전이 빠르면 소프트웨어의 발전도 빠르다.

예를 들어, CPU와 메모리의 발전에 따라 텍스트 기반의 OS에서 GUI 기반의 OS로 변화했고, CPU의 크기 축소로 스마트폰이 등장하면서 앱 개발이 활성화되었다. CPU 성능 향상이 한계에 다다르면서 이제는 8개의 코어가 기본이 되었고, 이에 따라 소프트웨어는 병렬처리를 효율적으로 수행하도록 변화하였다. 통신 인프라의 발전에 따라 클라우드 컴퓨팅이 등장했으며, CPU와 메모리의 발전으로 가상화 기술도 발전하고 있다.

만약 VR이 대중화된다면 그에 맞는 새로운 인터페이스가 필요하게 될 것이고, SSD의 속도가 계속 향상된다면 메인 메모리의 개념이 사라질 수도 있다.

이처럼 하드웨어의 발전에 따라 새로운 플랫폼과 개념이 등장하고, 그에 따라 소프트웨어도 계속 변화해야 한다. 어느 쪽이든, 가능한 한 기존 코드를 활용하는 것이 효율적이기 때문에, 좋은 코드를 작성하는 것이 중요하다는 것을 잊지 말아야 한다.

이런 식으로 변화는 불가피하게 찾아오며, 기능 개선에 대한 요구 역시 끊임없이 이어진다.

## 좋은 코드를 위한 도구와 전략

이 글의 주제는 `좋은 코드`이지만, 여기서 이야기하는 '코드'는 단순히 'printf("hello world!")'와 같은 좁은 의미의 코드를 의미하지 않는다. 여기서 말하는 '코드'는 표준화된 인터페이스와 유연한 아키텍처 등 '변화에 대응하는 기술적인 방법 모두'를 포함한다.

그 중에서도 리팩토링은 좋은 시작점이다. 리팩토링은 현재 코드의 문제점을 파악하고, 그 문제점을 개선하는 방법이다. 이에 대한 자세한 내용은 `Martin Fowler`의 `Refactoring`을 추천한다.

변화에 대응하는 방법들 중 대표적인 것들을 아래에 나열하였다. 이는 전부가 아니며, 기준에 따라서는 더 많은 방법들이 존재할 수 있다. 중요한 것은 변화에 대응하기 위해서 다양한 방법들이 존재한다는 사실이다.

- 설계 방법: OOP(객체지향 프로그래밍), 디자인 패턴, Layered 아키텍처, MVC(Model-View-Controller)/MVVM(Model-View-ViewModel), MSA(Microservices Architecture) 등
- 개발 도구: Java, .NET, React Native, Flutter, TypeORM, MyBatis, Docker/Kubernetes 등
- 개발 방법론: TDD(Test-Driven Development), DDD(Domain-Driven Design), 애자일 등

위의 설계 방법과 도구들이 공통으로 가지고 있는 특징은 바로 '변화에 대응한다'는 점이다. 변화의 대상을 정의하고 그 변화에 독립적인 솔루션을 제시한다. 이는 코드에도 마찬가지이며, 좋은 코드란 변화에 쉽게 적응하는 코드다. 이런 코드의 특징은 의존성이 낮고 응집성이 높은 것이다. 그래서 패턴이나 아키텍처의 핵심은 규모만 다를 뿐, 의존성과 응집성에 대한 이야기다.

변화에 대응하는 방법들에 대한 많은 서적들이 있다. 그 중 일부는 의존성과 응집성을 직접적으로 이야기하기도 하며, 그렇지 않더라도 모든 서적들은 결국 변화에 대한 이야기다. 그리고 이 블로그에서도 좋은 코드, 즉 응집성과 의존성에 대한 이야기를 하려 한다.

![의존성/응집성](/assets/refs/cohesion-coupling.png)
그림1 - 의존성과 응집성
> 다른 모듈과의 관계는 최소화하며, 관련있는 요소들은 최대한 응집하여 변화의 영향이 다른 곳에 전파되는 것을 최소화 할 수 있다.

마지막으로, 위에 나열한 개발 방법과 도구들에 대한 지나친 집착은 피해야 한다. 문제의 본질을 이해하고 예측할 수 있다면, 변화에 대응하는 것은 비교적 쉽고 도구도 올바르게 사용할 수 있다. 반대로 도구에만 집착하면 오버엔지니어링이 될 수 있다. 도구는 수단이지 목적이 아님을 잊지 말아야 한다.

## 결론

React, NodeJS와 같은 응용 기술은 변화가 빠르기 때문에 한 프로그래머가 여러 영역에 걸쳐서 전문성을 유지하기 쉽지 않다. 반면에 패턴과 아키텍처와 같은 개발 이론의 지식은 쉽게 얻을 수 없지만, 얻게 되면 모든 분야에 유용하다. 설계 없는 개발은 있을 수 없는 일이다.

어떤 사람은 디자인 패턴을 공부하더라도 다른 프로그래머들이 이해하지 못하기 때문에 쓸모가 없다고 말한다. 그러나 시니어나 팀장이 되면 전체적인 틀을 잡고 주니어들에게 가이드를 제공하며 작업을 진행하게 된다. 이때 소프트웨어 공학에 능숙하다면 더 나은 가이드를 제공할 수 있다.

컴퓨터가 처음 개발되었을 때는 하드웨어 성능이 부족했지만, 지금은 하드웨어 성능이 충분하다. 그래서 소프트웨어는 성능 효율보다는 변경 효율에 중점을 두고 발전하고 있다. Docker나 크로스플랫폼과 같은 기술들이 이를 반영하고 있다. 이에 따라 현대의 좋은 코드란 변화에 잘 적응하는 코드다. 그래서 코드의 품질을 판단하는 기준도 변화에 얼마나 잘 적응하는지에 달려 있다.

마지막으로, 지식만으로는 프로젝트를 완성할 수 없다. 나와 상대방을 아우르는 현명함이 필요하다. 그래서 이 블로그에서는 개발 방법론 뿐만 아니라, 여러 회사를 거치면서 어려웠던 경험들을 공유하려고 한다. 이 블로그가 Manner Code인 이유이다.
